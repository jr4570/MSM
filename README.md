---

# Minecraft Server Manager (多功能 Minecraft 伺服器管理腳本)

一個強大且易於使用的單檔案 Bash 腳本，旨在簡化在 Linux 伺服器上部署和管理多個 Minecraft 伺服器的所有流程。無論您是初學者還是有經驗的管理員，此腳本都能幫助您節省時間並避免繁瑣的手動操作。

[English Readme](./README_EN.md) 

## ✨ 功能亮點 (Features)

*   **🌐 多語言介面**: 啟動時可選擇繁體中文或英文介面。
*   **🧩 依賴自動處理**: 自動檢測 `java`, `curl`, `jq`, `screen` 等必要工具，並提示引導式安裝。
*   **⚙️ 一鍵伺服器部署**:
    *   支援主流伺服器核心：**Paper**, **Fabric**, **Vanilla**。
    *   可使用**自訂 JAR 檔案**或 ZIP 檔案。
    *   自動從官方 API 獲取並下載最新或指定的 Minecraft 版本。
*   **🗂️ 多實例管理**: 在單一主機上輕鬆創建和管理多個完全獨立的伺服器實例。
*   **📦 插件/模組管理**:
    *   直接連接 **Modrinth API** 進行搜索、選擇和安裝插件/模組。
    *   輕鬆列出和移除已安裝的項目。
    *   針對 Fabric 伺服器，會自動提示安裝 Fabric API。
*   **🕹️ 全方位伺服器控制**:
    *   在背景 (`screen`) 啟動伺服器。
    *   平滑停止伺服器（帶有倒數計時警告）。
    *   隨時附加到伺服器控制台以手動輸入指令。
*   **🔧 伺服器配置**: 通過菜單輕鬆修改 `server.properties` 中的常用設定，如 `online-mode`, `MOTD`, `max-players` 等。
*   **🛡️ 備份與還原**: 一鍵為您的伺服器（包含世界、插件等所有檔案）創建 `tar.gz` 壓縮備份，並可從備份列表中選擇還原。
*   **🧑‍🤝‍🧑 玩家管理**: 方便地查看在線玩家列表或授予玩家 OP 權限。
*   **📜 引導式 EULA 同意**: 部署流程會引導您閱讀並親自同意 Minecraft EULA，完全合規。
*   **⬆️ 伺服器核心升級**: 自動檢查 Paper 伺服器是否有新版本，並提供一鍵升級功能。
*   **✅ 使用者友好**: 全數字菜單式操作，減少輸入錯誤，並提供清晰的錯誤提示和引導。

## ⚙️ 環境需求 (Requirements)

*   一個基於 **Linux** 的作業系統 (例如：Debian, Ubuntu, CentOS, Fedora 等)。
*   **Bash Shell**。
*   **Sudo/Root 權限** (僅在首次運行、需要自動安裝依賴工具時需要)。
*   網路連接 (用於下載伺服器檔案、插件和依賴)。

本腳本會自動檢查以下依賴，若缺失會提示安裝：
*   **Java 17 或更高版本** (現代 Minecraft 伺服器的基本要求，腳本會對版本進行檢查)。
*   `curl`
*   `jq`
*   `screen`

## 🚀 快速開始 (Quick Start)

1.  **下載腳本**
    將腳本內容複製到您的伺服器中，並儲存為 `msm.sh`。

    或
    
    打開您的終端，並執行以下命令：
    ```bash
    curl -o msm.sh  https://github.com/jr4570/Minecraft-Server-Management-Script/releases/download/MSM_V2.0/msm_v2.1.4.sh
    ```

3.  **賦予執行權限**
    打開您的終端，並執行以下命令：
    ```bash
    chmod +x msm.sh
    ```

4.  **運行腳本**
    執行腳本以開始：
    ```bash
    ./ msm.sh
    ```

## 📖 使用教學 (Usage Walkthrough)

### 1. 首次運行
腳本第一次啟動時，會：
*   讓您選擇操作語言。
*   檢查所有必要的依賴工具。如果發現有工具未安裝，會詢問您是否要授權腳本嘗試自動安裝。

### 2. 主選單
您會看到一個清晰的主選單：
*   `1. 部署新伺服器`: 創建一個全新的伺服器實例。
*   `2. 管理現有伺服器`: 管理您已經創建的所有伺服器。
*   `3. 退出`: 離開腳本。

### 3. 部署新伺服器
選擇部署後，腳本將引導您完成以下步驟：
1.  **命名伺服器**: 例如 `my_survival_world`。
2.  **設置記憶體**: 分別輸入最小 (Xms) 和最大 (Xmx) 記憶體，例如 `2G`, `4G`。
3.  **選擇類型**: 從 Paper, Fabric, Vanilla, 或自訂 JAR 中選擇。
4.  **選擇版本**: 腳本會從網路獲取可用的 Minecraft 版本供您選擇。
5.  **同意 EULA**: 腳本會顯示官方 EULA 連結，您必須輸入 `yes` 以繼續。
完成後，所有檔案將被下載和設置妥當。

### 4. 管理現有伺服器
選擇此選項後，您會看到您已建立的伺服器列表。選擇其中一個，即可進入該伺服器的專屬管理菜單，您可以：
*   **啟動/停止/進入控制台**: 進行基本的伺服器操作。
*   **插件/模組管理**: 搜索和安裝來自 Modrinth 的新內容。
*   **備份/還原**: 保護您的伺服器數據安全。
*   **設定 server.properties**: 快速調整伺服器規則。
*   **刪除伺服器**: **此操作不可逆**，會刪除伺服器的所有檔案。

## 📁 檔案結構說明 (File Structure)

所有伺服器都存放在 `~/mc_servers/` 目錄下，每個伺服器都是一個獨立的子目錄：

```
/home/user/mc_servers/
└── my_survival_world/      # 您的伺服器實例名稱
    ├── world/              # 世界檔案
    ├── plugins/            # 插件目錄 (Paper/Spigot)
    ├── mods/               # 模組目錄 (Fabric)
    ├── backups/            # 備份檔案存放地
    │   └── backup-2023-10-27_10-30-00.tar.gz
    ├── server.properties   # 伺服器設定檔
    ├── eula.txt            # EULA 同意檔案
    ├── paper-1.20.2-313.jar # 伺服器核心檔案 (範例)
    ├── start.sh            # 啟動腳本
    ├── latest.log          # 伺服器日誌
    ├── .server_type        # 腳本使用的元數據 (記錄伺服器類型)
    ├── .mc_version         # 腳本使用的元數據 (記錄 MC 版本)
    └── .jar_name           # 腳本使用的元數據 (記錄核心檔案名)
```

## ⚠️ 注意事項 (Disclaimer)

*   此腳本由 AI 輔助生成，儘管經過多次測試，仍可能存在未知的錯誤。
*   在執行「還原」或「刪除」等高風險操作前，請務必確認您的選擇，並建議您有額外的手動備份。
*   作者不對任何因使用此腳本可能導致的數據遺失負責。
